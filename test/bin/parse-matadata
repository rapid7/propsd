#!/usr/bin/env node

/**
 * Parse the JSON document generated by get-metadata into a JSON document that the
 * Metadata Parser can grok.
 */

const FS = require('fs');
const Path = require('path');
const Util = require('../../dist/lib/source/metadata/util');

const metadata = require('../data/metadata-paths.json');

const results = Util.traverse(
  'latest',
  ['/meta-data/', '/dynamic/'],

  // Call `Metadata.request` for each path
  (path, cb) => cb(null, metadata[path]));

if (results.error) {
  throw results.error;
}

FS.writeFileSync(Path.resolve(__dirname, '../data/metadata-values.json'), JSON.stringify(results.values, null, 2));
